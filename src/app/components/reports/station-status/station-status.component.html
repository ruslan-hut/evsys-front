@if (loading) {
  <div><mat-progress-bar mode="indeterminate"></mat-progress-bar></div>
}

<div class="status-header">
  <div class="summary-cards">
    <mat-card class="summary-card online">
      <mat-card-content>
        <div class="summary-value">{{ onlineCount }}</div>
        <div class="summary-label">Online</div>
      </mat-card-content>
    </mat-card>
    <mat-card class="summary-card offline">
      <mat-card-content>
        <div class="summary-value">{{ offlineCount }}</div>
        <div class="summary-label">Offline</div>
      </mat-card-content>
    </mat-card>
    <mat-card class="summary-card total">
      <mat-card-content>
        <div class="summary-value">{{ stations.length }}</div>
        <div class="summary-label">Total</div>
      </mat-card-content>
    </mat-card>
  </div>
  @if (!(isMobile$ | async)) {
    <button mat-icon-button (click)="refresh()" [disabled]="loading" matTooltip="Refresh" aria-label="Refresh station status">
      <mat-icon>refresh</mat-icon>
    </button>
  }
</div>

@if (isMobile$ | async) {
  <button mat-fab class="fab-refresh" (click)="refresh()" [disabled]="loading" aria-label="Refresh station status">
    <mat-icon>refresh</mat-icon>
  </button>
}

@if (!loading && stations.length === 0) {
  <div class="no-data">No station data available</div>
}

<div class="status-grid">
  @for (station of stations; track station.charge_point_id) {
    <mat-card class="station-card" [class.online]="isOnline(station)" [class.offline]="!isOnline(station)" (click)="navigateToStation(station.charge_point_id)">
      <div class="card-content">
        <span class="station-id">{{ station.charge_point_id }}</span>
        <span class="status-indicator" [class.online]="isOnline(station)" [class.offline]="!isOnline(station)">
          {{ station.state }}
        </span>
        <span class="duration-value" [class.online]="isOnline(station)" [class.offline]="!isOnline(station)">
          {{ formatDuration(station.duration_seconds) }}
        </span>
        <span class="since-value">{{ formatSince(station.since) }}</span>
      </div>
    </mat-card>
  }
</div>
